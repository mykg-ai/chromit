(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a52f292"],{4337:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:null==t.visitUserInfo,expression:"visitUserInfo==null"}],staticClass:"main"},[null!=t.visitUserInfo&&""!=t.visitUserInfo?n("div",{staticClass:"user-box"},[n("el-container",[n("el-aside",[n("el-avatar",{staticClass:"login-avatar",attrs:{fit:"'fill'",size:200,shape:"square",src:t.visitUserInfo.settings["avatar_url"]},on:{error:!0}},[t._v("\n          "+t._s(t.visitUserInfo.username)+"\n        ")])],1),n("el-container",{staticStyle:{"margin-left":"10px"}},[n("el-header",[t._v(t._s(t.visitUserInfo.settings["full_name"]))]),n("el-main",[t._v(t._s(t.$t("user.a"))+": "+t._s(t.visitUserInfo.settings["bio"]))])],1)],1)],1):t._e(),""==t.visitUserInfo?n("div",[n("div",{staticStyle:{"margin-top":"150px"}},[n("Button",{staticStyle:{"font-size":"53px",width:"80px",height:"80px","margin-bottom":"20px"},attrs:{shape:"circle",icon:"logo-freebsd-devil"}}),n("br"),n("b",{staticStyle:{"font-size":"30px"}},[t._v("404")]),n("br"),n("br"),"params"in t.$route?n("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.$t("user.b"))+" \n        "),n("span",{staticStyle:{color:"#57a3f3"}},[t._v(t._s(t.$route.params.username))]),t._v(" !\n      ")]):t._e(),n("br"),n("br")],1)]):t._e(),null!=this.visitUserInfo&&1==this.visitUserInfo.settings.show_public?n("UserKg",{staticClass:"user-kg",attrs:{homeActive:t.homeActive,center:t.visitUserInfo.settings.graph_query}}):t._e()],1)},a=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"main",attrs:{id:"userKg-id"}},[t.loading?t._e():n("svg",[n("g",{staticClass:"g-zoom"},[n("g",{staticClass:"g-move2center"},[n("g",{staticClass:"link-container"},[n("defs",[t._l(t.svgData.c2i,function(t){return n("marker",{staticClass:"center-inner-marker",attrs:{id:"marker-"+t.id,orient:"auto",markerWidth:"10",markerHeight:"10",viewBox:"-14 -10 28 20"}},[n("path",{attrs:{d:"M0,0L -12,8L-12,-8L0,0"}})])}),t._l(t.svgData.i2o,function(t){return n("marker",{staticClass:"inner-outer-marker",attrs:{id:"marker-"+t.id,orient:"auto",markerWidth:"10",markerHeight:"10",viewBox:"-14 -10 28 20"}},[n("path",{attrs:{d:"M0,0L -12,8L-12,-8L0,0"}})])})],2),t._l(t.svgData.c2i,function(t){return n("g",{staticClass:"center-inner-path",attrs:{id:"path-"+t.id,"marker-end":"url(#marker-"+t.id+")"}},[n("path")])}),t._l(t.svgData.i2o,function(t){return n("g",{staticClass:"inner-outer-path",attrs:{id:"path-"+t.id,"marker-end":"url(#marker-"+t.id+")"}},[n("path")])})],2),n("g",{staticClass:"node-container"},[n("g",{staticClass:"node-center"},[n("circle",{staticStyle:{fill:"#fff"},attrs:{r:t.centerNodeProp.r1}}),n("circle",{attrs:{r:t.centerNodeProp.r2}}),n("text",{domProps:{innerHTML:t._s(t.$options.filters.handleCenterText(t.svgData.center.name))}})]),t._l(t.svgData.inner,function(e){return n("g",{staticClass:"node-inner"},[n("rect",{attrs:{width:t.innerNodeProp.w,height:t.innerNodeProp.h,x:-t.innerNodeProp.w/2,y:-t.innerNodeProp.h/2}}),n("text",{domProps:{innerHTML:t._s(t.$options.filters.handleInnerText(e.name))}})])}),t._l(t.svgData.outer,function(e){return n("g",{staticClass:"node-outer"},[n("circle",{attrs:{r:t.outerNodeProp.r}}),n("text",{domProps:{innerHTML:t._s(t.$options.filters.handleOuterText(e.name))}})])})],2)])])]),n("div",{staticClass:"svg-tool"},[n("el-tooltip",{attrs:{content:t.$t("favoriteKg.a1"),placement:"top","open-delay":2e3,effect:"light"}},[n("img",{attrs:{src:"/static/img/full_screen.svg"},on:{click:function(e){t.fullScreen=!t.fullScreen,t.clickFullScreen()}}})]),n("el-tooltip",{attrs:{content:t.$t("favoriteKg.a2"),placement:"top","open-delay":2e3,effect:"light"}},[n("img",{attrs:{src:"/static/img/transform.svg"},on:{click:function(e){return t.clickTransform()}}})]),n("el-tooltip",{attrs:{content:t.$t("favoriteKg.a3"),placement:"top","open-delay":2e3,effect:"light"}},[n("img",{attrs:{src:"/static/img/"+(t.lock?"lock":"unlock")+".svg"},on:{click:function(e){return t.clickLock()}}})]),n("el-tooltip",{attrs:{content:t.$t("favoriteKg.a4"),placement:"top","open-delay":2e3,effect:"light"}},[n("img",{attrs:{src:"/static/img/refresh.svg"},on:{click:function(e){return t.refreshSvg()}}})])],1)])},i=[],o=n("db36"),l=n("fd65"),c=n("4e13"),h={name:"UserKg",data(){return{favoriteList:[],loading:!0,lock:!1,fullScreen:!1,simulation:null,svgData:{center:{},nodes:[],links:[]},centerNodeProp:{r1:54,r2:50},innerNodeProp:{w:100,h:30},outerNodeProp:{r:30},baseZoomInNum:6,minAndMaxZoom:[.2,5],forceStrength:-10,theta0:null,zoom:null}},props:["homeActive","center"],watch:{$route(t,e){this.changeRoute(t)}},filters:{handleCenterText(t){return this.handleText(t,14,4)},handleInnerText(t){return this.handleText(t,13,1)},handleOuterText(t){return this.handleText(t,8,3)},handleText(t,e,n){for(var s=Math.min(n,Math.ceil(this.getBLen(t)/e))>2?1:0,a=0,r=0,i='<tspan x="0" y="'+12*(r-s)+'">',o=0;o<t.length;o++)if(i+=t.charAt(o),a+=this.isCn(t.charAt(o))?2:1,a>e){if(a=0,r+=1,i+="</tspan>",r>=n){i+="...";break}o<t.length-1&&(i+='<tspan x="0" y="'+12*(r-s)+'">')}return i},getBLen(t){return null==t?0:("string"!=typeof t&&(t+=""),t.replace(/[^\x00-\xff]/g,"ab").length)},isCn(t){return null!=t.match(/[^\x00-\xff]/gi)}},mounted(){this.changeRoute(this.$route),window.onresize=this.updateSvgSize},methods:{clickFullScreen(){if(this.fullScreen){let t=document.getElementById("userKg-id");t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},clickTransform(){if(0!=this.svgData.nodes.length){var t=null,e=null,n=null,s=null,a=parseInt(document.getElementsByTagName("svg")[0].attributes.width.value),r=parseInt(document.getElementsByTagName("svg")[0].attributes.height.value);this.svgData.nodes.forEach(a=>{var r=a.id.indexOf("c")>-1?this.centerNodeProp.r1:a.id.indexOf("i")>-1?this.innerNodeProp.w/2:this.outerNodeProp.r,i=a.id.indexOf("c")>-1?this.centerNodeProp.r1:a.id.indexOf("i")>-1?this.innerNodeProp.h/2:this.outerNodeProp.r;s=Math.max(s,a.x*this.baseZoomInNum+r),e=Math.min(e,a.x*this.baseZoomInNum-r),t=Math.min(t,a.y*this.baseZoomInNum-i),n=Math.max(n,a.y*this.baseZoomInNum+i)});var i=s-e,o=a,c=n-t,h=r,u=Math.min(o/i,h/c),d=(s+e)/2*u,m=(n+t)/2*u,f=(1-u)/2;l["l"]("svg").transition().duration(1e3).call(this.zoom.transform,l["o"].translate(o*f-d,h*f-m).scale(u))}},clickLock(){this.lock=!this.lock,this.lock?(this.svgData.nodes.forEach(t=>{t.fx=t.x,t.fy=t.y}),this.simulation.stop()):(this.svgData.nodes.forEach(t=>{t.fx=null,t.fy=null}),this.simulation.alphaTarget(.1).restart())},refreshSvg(){this.lock&&this.clickLock(),l["l"]("svg").call(this.zoom.transform,l["o"])},changeRoute(t){this.loading=!0;var e=this.$route.params.username;this.$axios.get(c["a"].url+"/favorite/search_public?username="+e).then(t=>{this.favoriteList=t.data,this.loading=!1,this.handleSvg(this.center,this.favoriteList)}).catch(t=>this.loading=!1)},updateSvgSize(){var t=document.getElementById("userKg-id").offsetWidth,e=document.getElementById("userKg-id").offsetHeight;l["l"]("svg").attr("width",t).attr("height",e),l["l"](".g-move2center").attr("transform","translate("+[t/2,e/2]+")")},handleSvg(t,e){this.theta0=Math.atan2(this.innerNodeProp.h,this.innerNodeProp.w),new Promise((n,s)=>{var a={name:t,id:"c-0"};this.svgData=Object(o["c"])(a,e),n()}).then(()=>{this.updateSvgSize(),this.zoom=l["n"]().scaleExtent(this.minAndMaxZoom).on("zoom",t=>{l["l"](".g-zoom").attr("transform",l["d"].transform)}),l["l"]("svg").call(this.zoom).on("dblclick.zoom",null),this.simulation=l["h"](this.svgData.nodes).force("charge",l["g"]().strength(this.forceStrength)).force("link",l["f"](this.svgData.links).id(t=>t.id)).force("center",l["e"]())}).then(()=>{var t=l["b"]().on("start",t=>{l["d"].active||this.simulation.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}).on("drag",t=>{t.fx+=l["d"].dx/this.baseZoomInNum,t.fy+=l["d"].dy/this.baseZoomInNum}).on("end",t=>{l["d"].active||this.lock||this.simulation.alphaTarget(0),this.lock||(t.fx=null,t.fy=null)});l["l"](".node-center").data([this.svgData.center]).call(t),l["m"](".center-inner-path path").data(this.svgData.c2i),l["m"](".node-inner").data(this.svgData.inner).call(t).on("dblclick",t=>{window.open(t.url,"_blank").location}),l["m"](".inner-outer-path path").data(this.svgData.i2o),l["m"](".node-outer").data(this.svgData.outer).call(t)}).then(()=>{this.simulation.on("tick",()=>{l["l"](".node-center").attr("transform",t=>"translate("+[Object(o["a"])(t,!0,this.baseZoomInNum),Object(o["a"])(t,!1,this.baseZoomInNum)]+")"),l["m"](".center-inner-path path").attr("d",t=>Object(o["b"])(t,this.baseZoomInNum,this.theta0,this.centerNodeProp,this.innerNodeProp,this.outerNodeProp)),l["m"](".node-inner").attr("transform",t=>"translate("+[Object(o["a"])(t,!0,this.baseZoomInNum),Object(o["a"])(t,!1,this.baseZoomInNum)+")"]),l["m"](".inner-outer-path path").attr("d",t=>Object(o["b"])(t,this.baseZoomInNum,this.theta0,this.centerNodeProp,this.innerNodeProp,this.outerNodeProp)),l["m"](".node-outer").attr("transform",t=>"translate("+[Object(o["a"])(t,!0,this.baseZoomInNum),Object(o["a"])(t,!1,this.baseZoomInNum)+")"])})}).then(()=>setTimeout(this.clickTransform,1e3))}}},u=h,d=(n("d66f"),n("17cc")),m=Object(d["a"])(u,r,i,!1,null,"72d21281",null),f=m.exports,g={name:"User",data(){return{visitUser:"",visitUserInfo:null}},components:{UserKg:f},props:["homeActive"],watch:{$route(t,e){this.visitUserInfo=null,this.changeRoute()}},mounted(){this.changeRoute()},methods:{changeRoute(){this.visitUser=this.$route.params.username,console.log("visiting "+this.visitUser+"..."),this.$axios.get(c["a"].url+"/info/"+this.visitUser).then(t=>{this.visitUserInfo=t.data,console.log(this.visitUserInfo)}).catch(t=>{this.visitUserInfo="",console.log(t)})}}},v=g,p=(n("9927"),Object(d["a"])(v,s,a,!1,null,"68d50b38",null));e["default"]=p.exports},"4a99":function(t,e,n){},7491:function(t,e,n){},9927:function(t,e,n){"use strict";var s=n("7491"),a=n.n(s);a.a},d66f:function(t,e,n){"use strict";var s=n("4a99"),a=n.n(s);a.a},db36:function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});var s=n("fd65");const a=(t,e)=>{t.related_links=[],t.related_nodes=[];var n=s["i"](),a=[],r=[],i=[],o=0;return e.forEach(e=>{if(null!=e){var s=e.sysTags.concat(e.userTags),l={id:"i-"+a.length,name:e.title,parse:e.parse,tags:s,url:e.url,related_links:[],related_nodes:[]};a.push(l),s.forEach(t=>{var e=n.get(t);null==e&&(e={id:"o-"+o,name:t,related_links:[],related_nodes:[]},o++,n.set(t,e));var s={id:"l-"+l.id+"-"+e.id,source:l.id,target:e.id};i.push(s),l.related_nodes.push(e.id),l.related_links.push(s.id),e.related_nodes.push(l.id),e.related_links.push(s.id)});var c={id:"l-"+t.id+"-"+l.id,source:t.id,target:l.id};r.push(c),l.related_nodes.push(t.id),l.related_links.push(c.id),t.related_nodes.push(l.id),t.related_links.push(c.id)}}),{center:t,inner:a,outer:n.values(),nodes:a.concat(n.values()).concat([t]),c2i:r,i2o:i,links:r.concat(i)}},r=(t,e,n,s,a,r)=>{var o=i(t.source,!0,e),l=i(t.target,!0,e),c=i(t.source,!1,e),h=i(t.target,!1,e),u=0,d=0,m=0,f=0;if(t.id.indexOf("l-c")>-1){var g=Math.atan2(h-c,l-o),v=s.r1,p=a.w,x=a.h,k=(u=o+Math.cos(g)*v,d=c+Math.sin(g)*v,g<-Math.PI/2||g>Math.PI/2?-1:1),b=g>=0?1:-1;g>=-n&&g<=n||g>=Math.PI-n&&g<=Math.PI||g>=-Math.PI&&g<=-Math.PI+n?(m=l-p/2*k,f=h-p/2*Math.tan(g)*k):(m=l-x/2/Math.tan(g)*b,f=h-x/2*b)}else{g=Math.atan2(h-c,l-o),p=a.w,x=a.h;var _=r.r;m=l-Math.cos(g)*_,f=h-Math.sin(g)*_,k=g<-Math.PI/2||g>Math.PI/2?-1:1,b=g>=0?1:-1;g>=-n&&g<=n||g>=Math.PI-n&&g<=Math.PI||g>=-Math.PI&&g<=-Math.PI+n?(u=o+p/2*k,d=c+p/2*Math.tan(g)*k):(u=o+x/2/Math.tan(g)*b,d=c+x/2*b)}return"M"+[u,d]+"L"+[m,f]},i=(t,e,n)=>{return e?("fx"in t&&""!=t.fx&&null!=t.fx?t.fx:t.x)*n:("fy"in t&&""!=t.fy&&null!=t.fy?t.fy:t.y)*n}}}]);